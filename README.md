four_site.py ------利用socks代理对github、码云、百度文库、csdn的上传页面识别与拦截。

原理：利用拦截对上传行为有关系的资源、例如editer.js资源，当该资源拦截后能成功将上传行为变为不可用从而阻止上传行为。

模板类型：doc模板和js、css等资源模板，一般doc模板不需要缓存，只需要利用doc模板判断用户访问的页面，然后通过识别和拦截js、css等模板阻止上传。

模板计算：使用加密后tls包大小值。

模板构建：["sni",min_len,max_len] sni表示模板的域名、min_len表示模板最小tls长度，max_len最大tls长度。

识别算法：上传页面会先加载HTML资源，之后加载JS资源，首先监控上传页面HTML的SNI，对SNI加载的资源进行计数，当计数的值达到模板设置的HTML资源值,把它标记为疑似上传，通过设置定时器，在一定的时间之内判断是否加载JS资源的SNI并且加载的JS资源的大小在模板的区间内，被认定为上传。

http2.0协议处理：多路复用使得资源在流量中无法区分、通过将请求包进行延时解决多路复用的问题。

拦截算法：
  1：模板是doc(h1)+js、css(h2或者h1)直接拦截后面h2
  2：模板是js、css(h2)+js、css(h2)缓存第一个h2，直到识别到第二个h2资源，将两个资源都拦截，否则就释放
  
注意事项：使用前清空浏览器缓存、如果无法拦截可能需要更换资源模板。

